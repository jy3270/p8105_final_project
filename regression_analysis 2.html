<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regression analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Overview</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exploratory Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="visualization.html">Visualization</a>
    </li>
    <li>
      <a href="geospatial.html">Geospatial Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Statistical Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="statistical_tests.html">Statistical Test</a>
    </li>
    <li>
      <a href="regression_analysis.html">Regression Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown-header">About</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Regression analysis</h1>

</div>


<style type="text/css">

h1.title {
  text-align: center;
}

</style>
<p>Since our goal is to explore what kinds of features might influence
and best predict our outcome - ladder score. I am considering a multiple
linear regression to see how variables relate to the outcome. Once
important question that I am interested in is how much does GDP impacts
the Ladder Score, and does anything interact with GDP. Here we mainly
focus on our latest data - happiness report from 2021.</p>
<p> </p>
<div id="variable-description-put-it-in-the-data-description-part"
class="section level2">
<h2>variable description (put it in the data description part)</h2>
<ul>
<li><p>Ladder Score or Happiness Score: “Please imagine a ladder, with
steps numbered from 0 at the bottom to 10 at the top. The top of the
ladder represents the best possible life for you and the bottom of the
ladder represents the worst possible life for you. On which step of the
ladder would you say you personally feel you stand at this
time?”.</p></li>
<li><p>Log GDP per capita: It is the total monetary or market value of
all the finished goods and services produced within a country’s borders
in a specific time period.</p></li>
<li><p>Healthy life expectancy: Based on the data extracted from the
World Health Organization’s (WHO)</p></li>
<li><p>Social Suport: “If you were in trouble, do you have relatives or
friends you can count on to help you whenever you need them, or
not?”.</p></li>
<li><p>Freedom to make life choices: “Are you satisfied or dissatisfied
with your freedom to choose what you do with your life?”</p></li>
<li><p>Generosity: “Have you donated money to a charity in the past
month?” on GDP per capita.</p></li>
<li><p>Corruption Perception: “Is corruption widespread throughout the
government or not” and “Is corruption widespread within businesses or
not?”</p></li>
</ul>
</div>
<div id="change-column-names-and-check-if-there-is-na"
class="section level2">
<h2>Change column names and check if there is na</h2>
<p>We first rename the column name for further use and check if there is
NA. It turns out that no NA is in our dataset. What’s worth mentioning
is that we transform the ladder score according to their rank(largest
score as rank 1) to have a better understanding when comparing them.</p>
<p> </p>
</div>
<div
id="now-we-check-the-correlations-between-each-of-the-variables-and-then-we-print-the-correlation-matrix-and-plot-the-correlation-graph."
class="section level2">
<h2>Now, we check the correlations between each of the variables, and
then we print the correlation matrix and plot the correlation
graph.</h2>
<pre class="r"><code>num.var &lt;- select_if(hap, is.numeric)
M&lt;-cor(num.var)
M</code></pre>
<pre><code>##                     Ladder        GDP Social.support   Life.exp    Freedom
## Ladder          1.00000000 -0.7969875     -0.7510240 -0.7759416 -0.6064113
## GDP            -0.79698747  1.0000000      0.7852987  0.8594606  0.4323235
## Social.support -0.75102401  0.7852987      1.0000000  0.7232561  0.4829298
## Life.exp       -0.77594156  0.8594606      0.7232561  1.0000000  0.4614939
## Freedom        -0.60641135  0.4323235      0.4829298  0.4614939  1.0000000
## generosity      0.03966234 -0.1992864     -0.1149459 -0.1617503  0.1694374
## Currpotion      0.40065425 -0.3423374     -0.2032070 -0.3643735 -0.4013630
##                 generosity Currpotion
## Ladder          0.03966234  0.4006543
## GDP            -0.19928640 -0.3423374
## Social.support -0.11494585 -0.2032070
## Life.exp       -0.16175028 -0.3643735
## Freedom         0.16943737 -0.4013630
## generosity      1.00000000 -0.1639617
## Currpotion     -0.16396173  1.0000000</code></pre>
<pre class="r"><code>corrplot(M)</code></pre>
<p><img src="regression_analysis_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<p> </p>
</div>
<div
id="split-the-data-into-a-training-and-validation-set-and-star-our-analysis"
class="section level2">
<h2>Split the data into a training and validation set and star our
analysis</h2>
<p> </p>
</div>
<div
id="we-choose-to-use-north-america-and-anz-as-a-reference-group-for-comparision"
class="section level2">
<h2>We choose to use North America and ANZ as a reference group for
comparision</h2>
<pre class="r"><code>str(hap$Region)</code></pre>
<pre><code>##  Factor w/ 10 levels &quot;Central and Eastern Europe&quot;,..: 10 10 10 10 10 10 10 10 6 10 ...</code></pre>
<pre class="r"><code>levels(hap$Region)</code></pre>
<pre><code>##  [1] &quot;Central and Eastern Europe&quot;         &quot;Commonwealth of Independent States&quot;
##  [3] &quot;East Asia&quot;                          &quot;Latin America and Caribbean&quot;       
##  [5] &quot;Middle East and North Africa&quot;       &quot;North America and ANZ&quot;             
##  [7] &quot;South Asia&quot;                         &quot;Southeast Asia&quot;                    
##  [9] &quot;Sub-Saharan Africa&quot;                 &quot;Western Europe&quot;</code></pre>
<pre class="r"><code>hap$Region&lt;-relevel(hap$Region, ref=&quot;North America and ANZ&quot;)</code></pre>
<p> </p>
</div>
<div id="model-selection" class="section level2">
<h2>Model selection</h2>
<div id="full-model" class="section level3">
<h3>Full model</h3>
<pre class="r"><code>summary(train)</code></pre>
<pre><code>##       Country                                   Region       Ladder      
##  Albania  :  1   Sub-Saharan Africa                :31   Min.   :  3.00  
##  Algeria  :  1   Western Europe                    :14   1st Qu.: 44.50  
##  Argentina:  1   Central and Eastern Europe        :13   Median : 82.00  
##  Armenia  :  1   Latin America and Caribbean       :13   Mean   : 79.96  
##  Australia:  1   Middle East and North Africa      :12   3rd Qu.:119.00  
##  Austria  :  1   Commonwealth of Independent States: 8   Max.   :148.00  
##  (Other)  :105   (Other)                           :20                   
##       GDP         Social.support      Life.exp        Freedom      
##  Min.   : 6.635   Min.   :0.4890   Min.   :48.48   Min.   :0.4800  
##  1st Qu.: 8.456   1st Qu.:0.7255   1st Qu.:59.29   1st Qu.:0.7180  
##  Median : 9.487   Median :0.8210   Median :66.40   Median :0.7950  
##  Mean   : 9.333   Mean   :0.8032   Mean   :64.60   Mean   :0.7906  
##  3rd Qu.:10.297   3rd Qu.:0.8980   3rd Qu.:69.15   3rd Qu.:0.8780  
##  Max.   :11.647   Max.   :0.9830   Max.   :76.95   Max.   :0.9700  
##                                                                    
##    generosity         Currpotion    
##  Min.   :-0.28800   Min.   :0.0820  
##  1st Qu.:-0.12400   1st Qu.:0.6655  
##  Median :-0.03000   Median :0.7760  
##  Mean   :-0.01084   Mean   :0.7263  
##  3rd Qu.: 0.07550   3rd Qu.:0.8390  
##  Max.   : 0.54200   Max.   :0.9390  
## </code></pre>
<pre class="r"><code>colnames(train)</code></pre>
<pre><code>## [1] &quot;Country&quot;        &quot;Region&quot;         &quot;Ladder&quot;         &quot;GDP&quot;           
## [5] &quot;Social.support&quot; &quot;Life.exp&quot;       &quot;Freedom&quot;        &quot;generosity&quot;    
## [9] &quot;Currpotion&quot;</code></pre>
<pre class="r"><code>m1 &lt;- lm(Ladder ~ ., data = train[,-1])
summary(m1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Ladder ~ ., data = train[, -1])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -33.160 -13.303  -1.021  12.496  60.285 
## 
## Coefficients:
##                                          Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                              297.8030    50.0711   5.948 4.51e-08
## RegionCommonwealth of Independent States  25.7677    10.2086   2.524 0.013257
## RegionEast Asia                           11.8555    12.3806   0.958 0.340703
## RegionLatin America and Caribbean         -9.0051     8.6646  -1.039 0.301307
## RegionMiddle East and North Africa        24.5459     9.0353   2.717 0.007836
## RegionNorth America and ANZ               -6.8523    15.1294  -0.453 0.651644
## RegionSouth Asia                          40.0499    11.6176   3.447 0.000845
## RegionSoutheast Asia                      28.3348    10.2437   2.766 0.006818
## RegionSub-Saharan Africa                  22.9253    10.8305   2.117 0.036895
## RegionWestern Europe                      -5.7477     9.1016  -0.632 0.529229
## GDP                                      -12.7875     3.9852  -3.209 0.001818
## Social.support                           -75.4024    31.5198  -2.392 0.018715
## Life.exp                                   0.0648     0.7568   0.086 0.931941
## Freedom                                  -90.8450    24.2749  -3.742 0.000312
## generosity                                -8.6442    14.9009  -0.580 0.563210
## Currpotion                                22.5704    15.4423   1.462 0.147151
##                                             
## (Intercept)                              ***
## RegionCommonwealth of Independent States *  
## RegionEast Asia                             
## RegionLatin America and Caribbean           
## RegionMiddle East and North Africa       ** 
## RegionNorth America and ANZ                 
## RegionSouth Asia                         ***
## RegionSoutheast Asia                     ** 
## RegionSub-Saharan Africa                 *  
## RegionWestern Europe                        
## GDP                                      ** 
## Social.support                           *  
## Life.exp                                    
## Freedom                                  ***
## generosity                                  
## Currpotion                                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 20.25 on 95 degrees of freedom
## Multiple R-squared:  0.8119, Adjusted R-squared:  0.7823 
## F-statistic: 27.34 on 15 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="null-model" class="section level3">
<h3>Null model</h3>
<p>Looking at the null model, which is just the intercept (mean) of the
outcome variable.</p>
<pre class="r"><code>null &lt;- lm(Ladder ~ 1, data = train[,-1])
summary(null)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Ladder ~ 1, data = train[, -1])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -76.964 -35.464   2.036  39.036  68.036 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   79.964      4.119   19.41   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 43.4 on 110 degrees of freedom</code></pre>
<p> </p>
</div>
<div id="use-stepwise-comparision-procedure" class="section level3">
<h3>Use stepwise comparision procedure</h3>
<div
id="select-the-model-with-the-lowest-aic-which-uses-a-models-maximum-likelihood-estimation-log-likelihood-as-a-measure-of-fit."
class="section level4">
<h4>select the model with the lowest AIC, which uses a model’s maximum
likelihood estimation (log-likelihood) as a measure of fit.</h4>
<pre class="r"><code>step(m1)</code></pre>
<pre><code>## Start:  AIC=682.56
## Ladder ~ Region + GDP + Social.support + Life.exp + Freedom + 
##     generosity + Currpotion
## 
##                  Df Sum of Sq   RSS    AIC
## - Life.exp        1       3.0 38968 680.57
## - generosity      1     138.0 39103 680.95
## &lt;none&gt;                        38965 682.56
## - Currpotion      1     876.2 39841 683.03
## - Social.support  1    2347.2 41312 687.05
## - GDP             1    4223.1 43188 691.98
## - Freedom         1    5744.3 44709 695.82
## - Region          9   17659.0 56624 706.05
## 
## Step:  AIC=680.57
## Ladder ~ Region + GDP + Social.support + Freedom + generosity + 
##     Currpotion
## 
##                  Df Sum of Sq   RSS    AIC
## - generosity      1     145.1 39113 678.98
## &lt;none&gt;                        38968 680.57
## - Currpotion      1     897.6 39866 681.10
## - Social.support  1    2352.7 41321 685.07
## - GDP             1    5008.9 43977 691.99
## - Freedom         1    5748.4 44717 693.84
## - Region          9   19488.8 58457 707.58
## 
## Step:  AIC=678.98
## Ladder ~ Region + GDP + Social.support + Freedom + Currpotion
## 
##                  Df Sum of Sq   RSS    AIC
## &lt;none&gt;                        39113 678.98
## - Currpotion      1     970.9 40084 679.70
## - Social.support  1    2302.5 41416 683.33
## - GDP             1    4889.5 44003 690.06
## - Freedom         1    6111.8 45225 693.10
## - Region          9   19392.6 58506 705.68</code></pre>
<pre><code>## 
## Call:
## lm(formula = Ladder ~ Region + GDP + Social.support + Freedom + 
##     Currpotion, data = train[, -1])
## 
## Coefficients:
##                              (Intercept)  
##                                  296.039  
## RegionCommonwealth of Independent States  
##                                   26.090  
##                          RegionEast Asia  
##                                   11.988  
##        RegionLatin America and Caribbean  
##                                   -8.385  
##       RegionMiddle East and North Africa  
##                                   24.992  
##              RegionNorth America and ANZ  
##                                   -8.064  
##                         RegionSouth Asia  
##                                   39.925  
##                     RegionSoutheast Asia  
##                                   27.068  
##                 RegionSub-Saharan Africa  
##                                   23.161  
##                     RegionWestern Europe  
##                                   -5.987  
##                                      GDP  
##                                  -12.128  
##                           Social.support  
##                                  -74.255  
##                                  Freedom  
##                                  -92.682  
##                               Currpotion  
##                                   23.077</code></pre>
<pre class="r"><code>m1.step &lt;- lm(formula = Ladder ~ Region + GDP + Social.support + Freedom + Currpotion, data = train[, -1])

summary(m1.step)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Ladder ~ Region + GDP + Social.support + Freedom + 
##     Currpotion, data = train[, -1])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -33.077 -13.074   0.191  12.750  61.540 
## 
## Coefficients:
##                                          Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                               296.039     35.487   8.342    5e-13
## RegionCommonwealth of Independent States   26.090      9.893   2.637 0.009735
## RegionEast Asia                            11.988     12.168   0.985 0.326973
## RegionLatin America and Caribbean          -8.385      8.526  -0.984 0.327804
## RegionMiddle East and North Africa         24.992      8.643   2.892 0.004731
## RegionNorth America and ANZ                -8.064     14.804  -0.545 0.587166
## RegionSouth Asia                           39.925     11.474   3.479 0.000754
## RegionSoutheast Asia                       27.068      9.885   2.738 0.007349
## RegionSub-Saharan Africa                   23.161      9.058   2.557 0.012111
## RegionWestern Europe                       -5.987      8.937  -0.670 0.504459
## GDP                                       -12.128      3.483  -3.482 0.000747
## Social.support                            -74.255     31.074  -2.390 0.018799
## Freedom                                   -92.682     23.806  -3.893 0.000182
## Currpotion                                 23.077     14.872   1.552 0.123996
##                                             
## (Intercept)                              ***
## RegionCommonwealth of Independent States ** 
## RegionEast Asia                             
## RegionLatin America and Caribbean           
## RegionMiddle East and North Africa       ** 
## RegionNorth America and ANZ                 
## RegionSouth Asia                         ***
## RegionSoutheast Asia                     ** 
## RegionSub-Saharan Africa                 *  
## RegionWestern Europe                        
## GDP                                      ***
## Social.support                           *  
## Freedom                                  ***
## Currpotion                                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 20.08 on 97 degrees of freedom
## Multiple R-squared:  0.8112, Adjusted R-squared:  0.7859 
## F-statistic: 32.07 on 13 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Here we get the best performing model measuring by AIC. The predictor
includes Region, GDP, Social.support, Freedom and Currpotion.</p>
<p> </p>
</div>
<div id="plot-the-the-residuals-to-see-how-the-model-performs"
class="section level4">
<h4>Plot the the residuals to see how the model performs</h4>
<pre class="r"><code>plot(m1.step)</code></pre>
<p><img src="regression_analysis_files/figure-html/unnamed-chunk-9-1.png" width="90%" /><img src="regression_analysis_files/figure-html/unnamed-chunk-9-2.png" width="90%" /><img src="regression_analysis_files/figure-html/unnamed-chunk-9-3.png" width="90%" /><img src="regression_analysis_files/figure-html/unnamed-chunk-9-4.png" width="90%" /></p>
<p>Overall the residuals seem normally distributed and most assumptions
seem to be maintained. However, the Scale-Location plot does show some
heteroskedasticity, where the variance increases a bit around the
center.</p>
<p> </p>
</div>
</div>
</div>
<div
id="explore-if-there-is-an-interaction-effect-between-some-of-the-predictor.-here-are-some-plots-to-initiate-our-hypothesis"
class="section level2">
<h2>Explore if there is an interaction effect between some of the
predictor. Here are some plots to initiate our hypothesis</h2>
<p>It seems like GDP and Freedom may have some interaction.</p>
<p> </p>
</div>
<div id="model-the-interaction" class="section level2">
<h2>Model the interaction</h2>
<pre class="r"><code>#interactions
int.mod &lt;- lm(formula = Ladder ~ Region + GDP + Social.support + Freedom + GDP*Freedom, data = train[, -1])

summary(int.mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Ladder ~ Region + GDP + Social.support + Freedom + 
##     GDP * Freedom, data = train[, -1])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -35.946 -13.496  -1.871  13.290  62.118 
## 
## Coefficients:
##                                          Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                                81.853    118.267   0.692 0.490528
## RegionCommonwealth of Independent States   20.237      9.222   2.194 0.030595
## RegionEast Asia                             5.442     11.759   0.463 0.644516
## RegionLatin America and Caribbean          -9.024      8.363  -1.079 0.283235
## RegionMiddle East and North Africa         23.026      8.293   2.777 0.006593
## RegionNorth America and ANZ               -11.429     13.503  -0.846 0.399392
## RegionSouth Asia                           38.910     11.336   3.432 0.000881
## RegionSoutheast Asia                       25.842      9.675   2.671 0.008870
## RegionSub-Saharan Africa                   22.772      8.817   2.583 0.011294
## RegionWestern Europe                       -7.585      8.304  -0.913 0.363281
## GDP                                        13.434     12.943   1.038 0.301877
## Social.support                            -63.324     29.972  -2.113 0.037186
## Freedom                                   204.900    146.719   1.397 0.165736
## GDP:Freedom                               -33.665     15.831  -2.127 0.035997
##                                             
## (Intercept)                                 
## RegionCommonwealth of Independent States *  
## RegionEast Asia                             
## RegionLatin America and Caribbean           
## RegionMiddle East and North Africa       ** 
## RegionNorth America and ANZ                 
## RegionSouth Asia                         ***
## RegionSoutheast Asia                     ** 
## RegionSub-Saharan Africa                 *  
## RegionWestern Europe                        
## GDP                                         
## Social.support                           *  
## Freedom                                     
## GDP:Freedom                              *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.87 on 97 degrees of freedom
## Multiple R-squared:  0.8152, Adjusted R-squared:  0.7904 
## F-statistic: 32.91 on 13 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We found that the slope of Freedom changes for every one increase in
GDP, and as GDP increases, slope of freedom decreases. Looking at the
p-value, the value of both GDP and Freedom indicate they’re
insignificant after we adding the interaction term, but the interaction
effect is significant now.</p>
<p> </p>
<div id="plot-the-residuals-to-see-the-distribution"
class="section level4">
<h4>Plot the residuals to see the distribution</h4>
<p> </p>
</div>
</div>
<div id="now-test-how-well-our-model-predicts-happiness-using-mse."
class="section level2">
<h2>Now test how well our model predicts Happiness using MSE.</h2>
<p>Since we have already altered the ladder score into scale of 1 to
149(country count), the error is reasonable to be large.</p>
<pre class="r"><code>predict_train &lt;- predict(int.mod, train)
predict_test &lt;- predict(int.mod, test)

train_MSE &lt;- mean((as.numeric(unlist(train[,&quot;Ladder&quot;])) - predict_train)^2)
train_MSE</code></pre>
<pre><code>## [1] 345.0328</code></pre>
<pre class="r"><code>test_MSE &lt;- mean((as.numeric(unlist(test[,&quot;Ladder&quot;])) - predict_test)^2)
test_MSE</code></pre>
<pre><code>## [1] 369.2025</code></pre>
<p> </p>
</div>
<div id="our-final-model" class="section level2">
<h2>our final model</h2>
<pre class="r"><code>summary(int.mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Ladder ~ Region + GDP + Social.support + Freedom + 
##     GDP * Freedom, data = train[, -1])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -35.946 -13.496  -1.871  13.290  62.118 
## 
## Coefficients:
##                                          Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                                81.853    118.267   0.692 0.490528
## RegionCommonwealth of Independent States   20.237      9.222   2.194 0.030595
## RegionEast Asia                             5.442     11.759   0.463 0.644516
## RegionLatin America and Caribbean          -9.024      8.363  -1.079 0.283235
## RegionMiddle East and North Africa         23.026      8.293   2.777 0.006593
## RegionNorth America and ANZ               -11.429     13.503  -0.846 0.399392
## RegionSouth Asia                           38.910     11.336   3.432 0.000881
## RegionSoutheast Asia                       25.842      9.675   2.671 0.008870
## RegionSub-Saharan Africa                   22.772      8.817   2.583 0.011294
## RegionWestern Europe                       -7.585      8.304  -0.913 0.363281
## GDP                                        13.434     12.943   1.038 0.301877
## Social.support                            -63.324     29.972  -2.113 0.037186
## Freedom                                   204.900    146.719   1.397 0.165736
## GDP:Freedom                               -33.665     15.831  -2.127 0.035997
##                                             
## (Intercept)                                 
## RegionCommonwealth of Independent States *  
## RegionEast Asia                             
## RegionLatin America and Caribbean           
## RegionMiddle East and North Africa       ** 
## RegionNorth America and ANZ                 
## RegionSouth Asia                         ***
## RegionSoutheast Asia                     ** 
## RegionSub-Saharan Africa                 *  
## RegionWestern Europe                        
## GDP                                         
## Social.support                           *  
## Freedom                                     
## GDP:Freedom                              *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.87 on 97 degrees of freedom
## Multiple R-squared:  0.8152, Adjusted R-squared:  0.7904 
## F-statistic: 32.91 on 13 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="freedom-and-gdps-correlation" class="section level2">
<h2>Freedom and GDP’s correlation</h2>
<pre class="r"><code>cor(hap$GDP, hap$Freedom)</code></pre>
<pre><code>## [1] 0.4323235</code></pre>
</div>
<div id="ladder-and-gdps-correlation" class="section level2">
<h2>Ladder and GDP’s correlation</h2>
<pre class="r"><code>cor(hap$GDP, hap$Ladder)</code></pre>
<pre><code>## [1] -0.7969875</code></pre>
<p>The correlations between GDP and Ladder Score seem very strong, and
the initial regression model would suggest that GDP is a powerful
predictor of the Happiness Ladder Score, but after adapting interaction
term and refit model, we found that the relationship between Freedom and
GDP cannot be ignored: these two seems to influence each other and we
cannot eliminate either of them.</p>
<p> </p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
